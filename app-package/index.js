!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){(function(i){var s;
/*!
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var t=this||n;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||n;if(t=parseFloat(t),e.ctx||f(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,n.ctx.currentTime);for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var s=e._howls[i]._getSoundIds(),r=0;r<s.length;r++){var o=e._howls[i]._soundById(s[r]);o&&o._node&&(o._node.volume=o._volume*t)}return e}return e._volume},mute:function(t){var e=this||n;e.ctx||f(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,n.ctx.currentTime);for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var s=e._howls[i]._getSoundIds(),r=0;r<s.length;r++){var o=e._howls[i]._soundById(s[r]);o&&o._node&&(o._node.muted=!!t||o._muted)}return e},unload:function(){for(var t=this||n,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,f()),t},codecs:function(t){return(this||n)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||n;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||n,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var i=e.canPlayType("audio/mpeg;").replace(/^no$/,""),s=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),r=s&&parseInt(s[0].split("/")[1],10)<33;return t._codecs={mp3:!(r||!i&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||n;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function e(i){for(var s=0;s<t.html5PoolSize;s++)try{var r=new Audio;r._unlocked=!0,t._releaseHtml5Audio(r)}catch(i){t.noAudio=!0}for(s=0;s<t._howls.length;s++)if(!t._howls[s]._webAudio)for(var n=t._howls[s]._getSoundIds(),o=0;o<n.length;o++){var a=t._howls[s]._soundById(n[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0);for(var i=0;i<t._howls.length;i++)t._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),t}},_obtainHtml5Audio:function(){var t=this||n;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||n;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&n.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var i=0;i<t._howls[e]._sounds.length;i++)if(!t._howls[e]._sounds[i]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then((function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())})))}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&n.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var n=new r,o=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};o.prototype={init:function(t){var e=this;return n.ctx||f(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhrWithCredentials=t.xhrWithCredentials||!1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=n.usingWebAudio&&!e._html5,void 0!==n.ctx&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var t=null;if(n.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var i,s;if(this._format&&this._format[e])i=this._format[e];else{if("string"!=typeof(s=this._src[e])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(s))||(i=/\.([^.]+)$/.exec(s.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&n.codecs(i)){t=this._src[e];break}}if(t)return this._src=t,this._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new a(this),this._webAudio&&u(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var i=this,s=null;if("number"==typeof t)s=t,t=null;else{if("string"==typeof t&&"loaded"===i._state&&!i._sprite[t])return null;if(void 0===t&&(t="__default",!i._playLock)){for(var r=0,o=0;o<i._sounds.length;o++)i._sounds[o]._paused&&!i._sounds[o]._ended&&(r++,s=i._sounds[o]._id);1===r?t=null:s=null}}var a=s?i._soundById(s):i._inactiveSound();if(!a)return null;if(s&&!t&&(t=a._sprite||"__default"),"loaded"!==i._state){a._sprite=t,a._ended=!1;var l=a._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(s&&!a._paused)return e||i._loadQueue("play"),a._id;i._webAudio&&n._autoResume();var u=Math.max(0,a._seek>0?a._seek:i._sprite[t][0]/1e3),d=Math.max(0,(i._sprite[t][0]+i._sprite[t][1])/1e3-u),h=1e3*d/Math.abs(a._rate),c=i._sprite[t][0]/1e3,f=(i._sprite[t][0]+i._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var _=function(){a._paused=!1,a._seek=u,a._start=c,a._stop=f,a._loop=!(!a._loop&&!i._sprite[t][2])};if(!(u>=f)){var g=a._node;if(i._webAudio){var p=function(){i._playLock=!1,_(),i._refreshBuffer(a);var t=a._muted||i._muted?0:a._volume;g.gain.setValueAtTime(t,n.ctx.currentTime),a._playStart=n.ctx.currentTime,void 0===g.bufferSource.start?a._loop?g.bufferSource.noteGrainOn(0,u,86400):g.bufferSource.noteGrainOn(0,u,d):a._loop?g.bufferSource.start(0,u,86400):g.bufferSource.start(0,u,d),h!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h)),e||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===n.state?p():(i._playLock=!0,i.once("resume",p),i._clearTimer(a._id))}else{var m=function(){g.currentTime=u,g.muted=a._muted||i._muted||n._muted||g.muted,g.volume=a._volume*n.volume(),g.playbackRate=a._rate;try{var s=g.play();if(s&&"undefined"!=typeof Promise&&(s instanceof Promise||"function"==typeof s.then)?(i._playLock=!0,_(),s.then((function(){i._playLock=!1,g._unlocked=!0,e||(i._emit("play",a._id),i._loadQueue())})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):e||(i._playLock=!1,_(),i._emit("play",a._id),i._loadQueue()),g.playbackRate=a._rate,g.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h):(i._endTimers[a._id]=function(){i._ended(a),g.removeEventListener("ended",i._endTimers[a._id],!1)},g.addEventListener("ended",i._endTimers[a._id],!1))}catch(t){i._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=i._src,g.load());var v=window&&window.ejecta||!g.readyState&&n._navigator.isCocoonJS;if(g.readyState>=3||v)m();else{i._playLock=!0;g.addEventListener(n._canPlayEvent,(function t(){m(),g.removeEventListener(n._canPlayEvent,t,!1)}),!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),s=0;s<i.length;s++){e._clearTimer(i[s]);var r=e._soundById(i[s]);if(r&&!r._paused&&(r._seek=e.seek(i[s]),r._rateSeek=0,r._paused=!0,e._stopFade(i[s]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var s=i._getSoundIds(t),r=0;r<s.length;r++){i._clearTimer(s[r]);var n=i._soundById(s[r]);n&&(n._seek=n._start||0,n._rateSeek=0,n._paused=!0,n._ended=!0,i._stopFade(s[r]),n._node&&(i._webAudio?n._node.bufferSource&&(void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),i._cleanBuffer(n._node)):isNaN(n._node.duration)&&n._node.duration!==1/0||(n._node.currentTime=n._start||0,n._node.pause(),n._node.duration===1/0&&i._clearSound(n._node))),e||i._emit("stop",n._id))}return i},mute:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(t,e)}}),i;if(void 0===e){if("boolean"!=typeof t)return i._muted;i._muted=t}for(var s=i._getSoundIds(e),r=0;r<s.length;r++){var o=i._soundById(s[r]);o&&(o._muted=t,o._interval&&i._stopFade(o._id),i._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,n.ctx.currentTime):o._node&&(o._node.muted=!!n._muted||t),i._emit("mute",o._id))}return i},volume:function(){var t,e,i,s=this,r=arguments;if(0===r.length)return s._volume;if(1===r.length||2===r.length&&void 0===r[1]){var o=s._getSoundIds(),a=o.indexOf(r[0]);a>=0?e=parseInt(r[0],10):t=parseFloat(r[0])}else r.length>=2&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(i=e?s._soundById(e):s._sounds[0])?i._volume:0;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"volume",action:function(){s.volume.apply(s,r)}}),s;void 0===e&&(s._volume=t),e=s._getSoundIds(e);for(var l=0;l<e.length;l++)(i=s._soundById(e[l]))&&(i._volume=t,r[2]||s._stopFade(e[l]),s._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(t,n.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=t*n.volume()),s._emit("volume",i._id));return s},fade:function(t,e,i,s){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,e,i,s)}}),r;t=parseFloat(t),e=parseFloat(e),i=parseFloat(i),r.volume(t,s);for(var o=r._getSoundIds(s),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l){if(s||r._stopFade(o[a]),r._webAudio&&!l._muted){var u=n.ctx.currentTime,d=u+i/1e3;l._volume=t,l._node.gain.setValueAtTime(t,u),l._node.gain.linearRampToValueAtTime(e,d)}r._startFadeInterval(l,t,e,i,o[a],void 0===s)}}return r},_startFadeInterval:function(t,e,i,s,r,n){var o=this,a=e,l=i-e,u=Math.abs(l/.01),d=Math.max(4,u>0?s/u:s),h=Date.now();t._fadeTo=i,t._interval=setInterval((function(){var r=(Date.now()-h)/s;h=Date.now(),a+=l*r,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,o._webAudio?t._volume=a:o.volume(a,t._id,!0),n&&(o._volume=a),(i<e&&a<=i||i>e&&a>=i)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(i,t._id),o._emit("fade",t._id))}),d)},_stopFade:function(t){var e=this._soundById(t);return e&&e._interval&&(this._webAudio&&e._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(e._interval),e._interval=null,this.volume(e._fadeTo,t),e._fadeTo=null,this._emit("fade",t)),this},loop:function(){var t,e,i,s=this,r=arguments;if(0===r.length)return s._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(i=s._soundById(parseInt(r[0],10)))&&i._loop;t=r[0],s._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var n=s._getSoundIds(e),o=0;o<n.length;o++)(i=s._soundById(n[o]))&&(i._loop=t,s._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t,t&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return s},rate:function(){var t,e,i,s=this,r=arguments;if(0===r.length)e=s._sounds[0]._id;else if(1===r.length){var o=s._getSoundIds(),a=o.indexOf(r[0]);a>=0?e=parseInt(r[0],10):t=parseFloat(r[0])}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if("number"!=typeof t)return(i=s._soundById(e))?i._rate:s._rate;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"rate",action:function(){s.rate.apply(s,r)}}),s;void 0===e&&(s._rate=t),e=s._getSoundIds(e);for(var l=0;l<e.length;l++)if(i=s._soundById(e[l])){s.playing(e[l])&&(i._rateSeek=s.seek(e[l]),i._playStart=s._webAudio?n.ctx.currentTime:i._playStart),i._rate=t,s._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(t,n.ctx.currentTime):i._node&&(i._node.playbackRate=t);var u=s.seek(e[l]),d=(s._sprite[i._sprite][0]+s._sprite[i._sprite][1])/1e3-u,h=1e3*d/Math.abs(i._rate);!s._endTimers[e[l]]&&i._paused||(s._clearTimer(e[l]),s._endTimers[e[l]]=setTimeout(s._ended.bind(s,i),h)),s._emit("rate",i._id)}return s},seek:function(){var t,e,i=this,s=arguments;if(0===s.length)e=i._sounds[0]._id;else if(1===s.length){var r=i._getSoundIds(),o=r.indexOf(s[0]);o>=0?e=parseInt(s[0],10):i._sounds.length&&(e=i._sounds[0]._id,t=parseFloat(s[0]))}else 2===s.length&&(t=parseFloat(s[0]),e=parseInt(s[1],10));if(void 0===e)return i;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,s)}}),i;var a=i._soundById(e);if(a){if(!("number"==typeof t&&t>=0)){if(i._webAudio){var l=i.playing(e)?n.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+l*Math.abs(a._rate))}return a._node.currentTime}var d=i.playing(e);d&&i.pause(e,!0),a._seek=t,a._ended=!1,i._clearTimer(e),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=t);var h=function(){i._emit("seek",e),d&&i.play(e,!0)};if(d&&!i._webAudio){var c=function t(){i._playLock?setTimeout(t,0):h()};setTimeout(c,0)}else h()}return i},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this._duration,i=this._soundById(t);return i&&(e=this._sprite[i._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,i=0;i<e.length;i++)e[i]._paused||t.stop(e[i]._id),t._webAudio||(t._clearSound(e[i]._node),e[i]._node.removeEventListener("error",e[i]._errorFn,!1),e[i]._node.removeEventListener(n._canPlayEvent,e[i]._loadFn,!1),n._releaseHtml5Audio(e[i]._node)),delete e[i]._node,t._clearTimer(e[i]._id);var s=n._howls.indexOf(t);s>=0&&n._howls.splice(s,1);var r=!0;for(i=0;i<n._howls.length;i++)if(n._howls[i]._src===t._src||t._src.indexOf(n._howls[i]._src)>=0){r=!1;break}return l&&r&&delete l[t._src],n.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,i,s){var r=this["_on"+t];return"function"==typeof e&&r.push(s?{id:i,fn:e,once:s}:{id:i,fn:e}),this},off:function(t,e,i){var s=this["_on"+t],r=0;if("number"==typeof e&&(i=e,e=null),e||i)for(r=0;r<s.length;r++){var n=i===s[r].id;if(e===s[r].fn&&n||!e&&n){s.splice(r,1);break}}else if(t)this["_on"+t]=[];else{var o=Object.keys(this);for(r=0;r<o.length;r++)0===o[r].indexOf("_on")&&Array.isArray(this[o[r]])&&(this[o[r]]=[])}return this},once:function(t,e,i){return this.on(t,e,i,1),this},_emit:function(t,e,i){for(var s=this["_on"+t],r=s.length-1;r>=0;r--)s[r].id&&s[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(this,s[r].fn),0),s[r].once&&this.off(t,s[r].fn,s[r].id));return this._loadQueue(t),this},_loadQueue:function(t){if(this._queue.length>0){var e=this._queue[0];e.event===t&&(this._queue.shift(),this._loadQueue()),t||e.action()}return this},_ended:function(t){var e=t._sprite;if(!this._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(this._ended.bind(this,t),100),this;var i=!(!t._loop&&!this._sprite[e][2]);if(this._emit("end",t._id),!this._webAudio&&i&&this.stop(t._id,!0).play(t._id),this._webAudio&&i){this._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=n.ctx.currentTime;var s=1e3*(t._stop-t._start)/Math.abs(t._rate);this._endTimers[t._id]=setTimeout(this._ended.bind(this,t),s)}return this._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,this._clearTimer(t._id),this._cleanBuffer(t._node),n._autoSuspend()),this._webAudio||i||this.stop(t._id,!0),this},_clearTimer:function(t){if(this._endTimers[t]){if("function"!=typeof this._endTimers[t])clearTimeout(this._endTimers[t]);else{var e=this._soundById(t);e&&e._node&&e._node.removeEventListener("ended",this._endTimers[t],!1)}delete this._endTimers[t]}return this},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e];return null},_inactiveSound:function(){this._drain();for(var t=0;t<this._sounds.length;t++)if(this._sounds[t]._ended)return this._sounds[t].reset();return new a(this)},_drain:function(){var t=this._pool,e=0,i=0;if(!(this._sounds.length<t)){for(i=0;i<this._sounds.length;i++)this._sounds[i]._ended&&e++;for(i=this._sounds.length-1;i>=0;i--){if(e<=t)return;this._sounds[i]._ended&&(this._webAudio&&this._sounds[i]._node&&this._sounds[i]._node.disconnect(0),this._sounds.splice(i,1),e--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],i=0;i<this._sounds.length;i++)e.push(this._sounds[i]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=n.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,n.ctx.currentTime),this},_cleanBuffer:function(t){var e=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=n._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++n._counter,t._sounds.push(this),this.create(),this},create:function(){var t=this._parent,e=n._muted||this._muted||this._parent._muted?0:this._volume;return t._webAudio?(this._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),this._node.gain.setValueAtTime(e,n.ctx.currentTime),this._node.paused=!0,this._node.connect(n.masterGain)):n.noAudio||(this._node=n._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(n._canPlayEvent,this._loadFn,!1),this._node.src=t._src,this._node.preload="auto",this._node.volume=e*n.volume(),this._node.load()),this},reset:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++n._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(n._canPlayEvent,this._loadFn,!1)}};var l={},u=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void c(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),s=new Uint8Array(i.length),r=0;r<i.length;++r)s[r]=i.charCodeAt(r);h(s.buffer,t)}else{var n=new XMLHttpRequest;n.open("GET",e,!0),n.withCredentials=t._xhrWithCredentials,n.responseType="arraybuffer",n.onload=function(){var e=(n.status+"")[0];"0"===e||"2"===e||"3"===e?h(n.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+n.status+".")},n.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},d(n)}},d=function(t){try{t.send()}catch(e){t.onerror()}},h=function(t,e){var i=function(){e._emit("loaderror",null,"Decoding audio data failed.")},s=function(t){t&&e._sounds.length>0?(l[e._src]=t,c(e,t)):i()};"undefined"!=typeof Promise&&1===n.ctx.decodeAudioData.length?n.ctx.decodeAudioData(t).then(s).catch(i):n.ctx.decodeAudioData(t,s,i)},c=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},f=function(){if(n.usingWebAudio){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(t){n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),e=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=e?parseInt(e[1],10):null;if(t&&i&&i<9){var s=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!s||n._navigator&&!n._navigator.standalone&&!s)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};void 0===(s=function(){return{Howler:n,Howl:o}}.apply(e,[]))||(t.exports=s),e.Howler=n,e.Howl=o,"undefined"!=typeof window?(window.HowlerGlobal=r,window.Howler=n,window.Howl=o,window.Sound=a):void 0!==i&&(i.HowlerGlobal=r,i.Howler=n,i.Howl=o,i.Sound=a)}()}).call(this,i(1))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}i.r(e);var r=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=null,this.topBarEl=null,this.timeBarEl=null,this.scoreEl=null,this.levelEl=null,this.levelNoEl=null,this.levelPrefixEl=null,this.dialogEl=null,this.dialogPointsEl=null,this.dialogPointsNoEl=null,this.dialogSuffixEl=null,this.controlsEl=null,this.gameOverEl=null,this.gameOverTextEl=null,this.isActive=!1,this.ad=null,this.willExit=!1}var e,i,r;return e=t,(i=[{key:"init",value:function(){this.topBarEl=document.createElement("div"),this.topBarEl.id="topbar",this.topBarEl.style.display="none",this.topBarEl.style.background="url(assets/topbar.png)",this.topBarEl.style.zIndex=9999,this.topBarEl.style.width="240px",this.topBarEl.style.height="44px",this.topBarEl.style.position="absolute",this.topBarEl.style.backgroundRepeat="no-repeat",this.timeBarEl=document.createElement("div"),this.timeBarEl.id="timebar",this.timeBarEl.style.position="absolute",this.timeBarEl.style.left="12px",this.timeBarEl.style.top="12px",this.timeBarEl.style.width="84px",this.timeBarEl.style.height="20px",this.timeBarEl.style.backgroundColor="#FFFFFF",this.scoreEl=document.createElement("div"),this.scoreEl.id="score",this.scoreEl.innerText="0 / 500",this.scoreEl.style.width="126px",this.scoreEl.style.position="relative",this.scoreEl.style.textAlign="right",this.scoreEl.style.left="106px",this.scoreEl.style.top="12px",this.scoreEl.style.letterSpacing="2px",this.scoreEl.style.fontSize="17.5px",this.scoreEl.style.color="#FFFFFF",this.scoreEl.style.fontFamily="AADigits",this.levelEl=document.createElement("div"),this.levelEl.id="level-bar",this.levelEl.style.position="relative",this.levelEl.style.width="228px",this.levelEl.style.height="25px",this.levelEl.style.letterSpacing="2px",this.levelEl.style.fontSize="17.5px",this.levelEl.style.color="#FFFFFF",this.levelEl.style.backgroundColor="#000000",this.levelEl.style.fontFamily="AADigits",this.levelEl.style.textAlign="center",this.levelEl.style.marginTop="-10px",this.levelEl.style.paddingTop="4px",this.levelEl.style.marginLeft="6px",this.levelEl.style.display="flex",this.levelEl.style.justifyContent="center",this.levelEl.style.lineHeight="20px",this.levelPrefixEl=document.createElement("img"),this.levelPrefixEl.id="level-prefix",this.levelPrefixEl.src="assets/level_prefix.png",this.levelPrefixEl.style.paddingRight="8px",this.levelPrefixEl.style.height="18px",this.levelNoEl=document.createElement("span"),this.levelNoEl.id="level-number",this.levelNoEl.innerText="1",this.levelEl.appendChild(this.levelPrefixEl),this.levelEl.appendChild(this.levelNoEl),this.topBarEl.appendChild(this.timeBarEl),this.topBarEl.appendChild(this.scoreEl),this.topBarEl.appendChild(this.levelEl),this.dialogEl=document.createElement("div"),this.dialogEl.id="dialog",this.dialogEl.style.display="none",this.dialogEl.style.position="absolute",this.dialogEl.style.zIndex=9999,this.dialogEl.style.width="172px",this.dialogEl.style.height="192px",this.dialogEl.style.marginLeft="34px",this.dialogEl.style.marginTop="50px",this.dialogEl.style.backgroundImage="url(assets/dialog_back.png)",this.dialogEl.style.backgroundRepeat="no-repeat",this.dialogPointsEl=document.createElement("div"),this.dialogPointsEl.style.width="100%",this.dialogPointsEl.style.letterSpacing="2px",this.dialogPointsEl.style.fontSize="17.5px",this.dialogPointsEl.style.color="#FFFFFF",this.dialogPointsEl.style.fontFamily="AADigits",this.dialogPointsEl.style.marginTop="70px",this.dialogPointsEl.style.textAlign="center",this.dialogPointsEl.style.display="flex",this.dialogPointsEl.style.justifyContent="center",this.dialogPointsEl.style.lineHeight="20px",this.dialogPointsNoEl=document.createElement("span"),this.dialogPointsNoEl.id="dialog-points",this.dialogPointsNoEl.innerText="500",this.dialogSuffixEl=document.createElement("img"),this.dialogSuffixEl.id="dialog-sufix",this.dialogSuffixEl.src="assets/points_suffix.png",this.dialogSuffixEl.style.paddingLeft="6px",this.dialogPointsEl.appendChild(this.dialogPointsNoEl),this.dialogPointsEl.appendChild(this.dialogSuffixEl),this.dialogEl.appendChild(this.dialogPointsEl),this.controlsEl=document.createElement("img"),this.controlsEl.id="controls",this.controlsEl.src="assets/controls.png",this.controlsEl.style.display="none",this.controlsEl.style.position="absolute",this.controlsEl.style.zIndex=9999,this.controlsEl.style.marginTop="252px",this.gameOverEl=document.createElement("div"),this.gameOverEl.style.width="240px",this.gameOverEl.style.height="320px",this.gameOverEl.style.position="absolute",this.gameOverEl.style.backgroundColor="#000000",this.gameOverEl.style.display="none",this.gameOverEl.style.justifyContent="center",this.gameOverEl.style.alignItems="center",this.gameOverTextEl=document.createElement("img"),this.gameOverTextEl.src="assets/game_over.png",this.gameOverTextEl.style.transition="opacity ease 2s",this.gameOverTextEl.style.opacity="0.0",this.gameOverEl.appendChild(this.gameOverTextEl),this.screen=document.getElementById("screen"),this.screen.appendChild(this.gameOverEl),this.screen.appendChild(this.topBarEl),this.screen.appendChild(this.dialogEl),this.screen.appendChild(this.controlsEl)}},{key:"showGameOver",value:function(){var t=this;this.topBarEl.style.visibility="hidden",document.getElementById("MainCanvas").style.visibility="hidden",this.topBarEl.style.visibility="hidden",this.gameOverEl.style.display="flex",setTimeout((function(){return t.gameOverTextEl.style.opacity="1.0"}),500),setTimeout((function(){confirm("Try again?")||(t.willExit=!0),t.showAd()}),3e3)}},{key:"showAd",value:function(){this.ad?this.ad.call("display"):this.redirectUser()}},{key:"redirectUser",value:function(){this.willExit?window.close():location.reload()}},{key:"prepareAd",value:function(){var t=this;window.getKaiAd&&window.getKaiAd({publisher:"98ce6faa-00cf-4756-b191-f7019c715e51",app:"Treasure Hunter",test:0,slot:"Game Over Screen",onerror:function(t){return console.error("Got error when trying to fetch ad:",t)},onready:function(e){t.ad=e,t.ad.on("close",(function(){return t.redirectUser()}))}})}},{key:"updateScore",value:function(t,e){this.scoreEl.innerText="".concat(t," / ").concat(e),this.isActive||(this.dialogPointsNoEl.innerText=e)}},{key:"updateLevel",value:function(t){this.levelNoEl.innerText=t,this.levelEl.style.display="flex"}},{key:"updateTime",value:function(t,e){t>=0&&(this.timeBarEl.style.width="".concat(2*Math.round(42*t/e),"px"))}},{key:"hideDialog",value:function(){this.dialogEl.style.display="none",this.controlsEl.style.display="none",this.levelEl.style.display="none"}},{key:"show",value:function(){this.topBarEl.style.removeProperty("display"),this.dialogEl.style.removeProperty("display"),this.controlsEl.style.removeProperty("display"),this.isActive=!0}}])&&s(e.prototype,i),r&&s(e,r),t}());i(0);function n(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.images={},this.sounds={},this.imageFiles={dig:"assets/dig.png",idle:"assets/idle.png",move:"assets/move.png",hurt:"assets/hurt.png",dirt:"assets/dirt.png",fire:"assets/fire.png",scorpion:"assets/scorpion.png",sky:"assets/sky.png",dithering:"assets/dithering.png",ground:"assets/ground.png",treasure0:"assets/treasure0.png",treasure1:"assets/treasure1.png",treasure2:"assets/treasure2.png",treasure3:"assets/treasure3.png",treasure4:"assets/treasure4.png",treasure5:"assets/treasure5.png",treasure6:"assets/treasure6.png",title:"assets/title.png",topbar:"assets/topbar.png",dialog_back:"assets/dialog_back.png",points_suffix:"assets/points_suffix.png",level_prefix:"assets/level_prefix.png",controls:"assets/controls.png"},this.soundFiles={start:"assets/snd_start.wav",dig:"assets/snd_dig.wav",good:"assets/snd_good.wav",hurt:"assets/snd_hurt.wav",step:"assets/snd_step.wav",loose:"assets/snd_loose.wav"}}var e,i,s;return e=t,(i=[{key:"load",value:function(){new FontFace("AADigits","url(assets/aadigits.ttf)").load().then((function(t){document.fonts.add(t)}));var t=new Promise((function(t,e){document.addEventListener("allimagesloaded",(function(){return t()}))})),e=new Promise((function(t,e){document.addEventListener("allsoundsloaded",(function(){return t()}))}));return this.loadImages(),this.loadSounds(),Promise.all([t,e])}},{key:"playSound",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.sounds[t].play();1!==e&&this.sounds[t].rate(e,i)}},{key:"loadSounds",value:function(){var t=Object.keys(this.soundFiles).length,e=0;for(var i in this.soundFiles)this.sounds[i]=new Howl({src:[this.soundFiles[i]],volume:.8}),this.sounds[i].once("load",(function(){(e+=1)===t&&document.dispatchEvent(new Event("allsoundsloaded"))}))}},{key:"loadImages",value:function(){var t=Object.keys(this.imageFiles).length,e=0;for(var i in this.imageFiles)this.images[i]=new Image,this.images[i].src=this.imageFiles[i],this.images[i].onload=function(){(e+=1)===t&&document.dispatchEvent(new Event("allimagesloaded"))}}}])&&n(e.prototype,i),s&&n(e,s),t}()),a=function(){var t=Float32Array;function e(e,i,s){return(s=s||new t(3))[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],s}function i(e,i){i=i||new t(3);var s=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return s>1e-5&&(i[0]=e[0]/s,i[1]=e[1]/s,i[2]=e[2]/s),i}function s(e,i,s){return(s=s||new t(3))[0]=e[1]*i[2]-e[2]*i[1],s[1]=e[2]*i[0]-e[0]*i[2],s[2]=e[0]*i[1]-e[1]*i[0],s}function r(t,e){var i=t[0]-e[0],s=t[1]-e[1],r=t[2]-e[2];return i*i+s*s+r*r}function n(e,i){i=i||new t(16);var s=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],d=e[7],h=e[8],c=e[9],f=e[10],_=e[11],g=e[12],p=e[13],m=e[14],v=e[15],y=f*v,x=m*_,E=u*v,b=m*d,w=u*_,A=f*d,T=n*v,k=m*o,S=n*_,B=f*o,P=n*d,L=u*o,F=h*p,I=g*c,R=a*p,M=g*l,O=a*c,C=h*l,U=s*p,z=g*r,D=s*c,N=h*r,q=s*l,G=a*r,V=y*l+b*c+w*p-(x*l+E*c+A*p),H=x*r+T*c+B*p-(y*r+k*c+S*p),j=E*r+k*l+P*p-(b*r+T*l+L*p),W=A*r+S*l+L*c-(w*r+B*l+P*c),X=1/(s*V+a*H+h*j+g*W);return i[0]=X*V,i[1]=X*H,i[2]=X*j,i[3]=X*W,i[4]=X*(x*a+E*h+A*g-(y*a+b*h+w*g)),i[5]=X*(y*s+k*h+S*g-(x*s+T*h+B*g)),i[6]=X*(b*s+T*a+L*g-(E*s+k*a+P*g)),i[7]=X*(w*s+B*a+P*h-(A*s+S*a+L*h)),i[8]=X*(F*d+M*_+O*v-(I*d+R*_+C*v)),i[9]=X*(I*o+U*_+N*v-(F*o+z*_+D*v)),i[10]=X*(R*o+z*d+q*v-(M*o+U*d+G*v)),i[11]=X*(C*o+D*d+G*_-(O*o+N*d+q*_)),i[12]=X*(R*f+C*m+I*u-(O*m+F*u+M*f)),i[13]=X*(D*m+F*n+z*f-(U*f+N*m+I*n)),i[14]=X*(U*u+G*m+M*n-(q*m+R*n+z*u)),i[15]=X*(q*f+O*n+N*u-(D*u+G*f+C*n)),i}return{copy:function(e,i){return(i=i||new t(16))[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},lookAt:function(r,n,o,a){a=a||new t(16);var l=i(e(r,n)),u=i(s(o,l)),d=i(s(l,u));return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=0,a[4]=d[0],a[5]=d[1],a[6]=d[2],a[7]=0,a[8]=l[0],a[9]=l[1],a[10]=l[2],a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a},addVectors:function(e,i,s){return(s=s||new t(3))[0]=e[0]+i[0],s[1]=e[1]+i[1],s[2]=e[2]+i[2],s},subtractVectors:e,distance:function(t,e){return Math.sqrt(r(t,e))},distanceSq:r,normalize:i,compose:function(e,i,s,r){r=r||new t(16);var n=i[0],o=i[1],a=i[2],l=i[3],u=n+n,d=o+o,h=a+a,c=n*u,f=n*d,_=n*h,g=o*d,p=o*h,m=a*h,v=l*u,y=l*d,x=l*h,E=s[0],b=s[1],w=s[2];return r[0]=(1-(g+m))*E,r[1]=(f+x)*E,r[2]=(_-y)*E,r[3]=0,r[4]=(f-x)*b,r[5]=(1-(c+m))*b,r[6]=(p+v)*b,r[7]=0,r[8]=(_+y)*w,r[9]=(p-v)*w,r[10]=(1-(c+g))*w,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},cross:s,decompose:function(t,e,i,s){var r,n,o,a,l,u,d,h,c,f,_,g,p,m,v,y,x,E,b,w,A,T,k,S,B,P,L,F,I,R=m4.length(t.slice(0,3)),M=m4.length(t.slice(4,7)),O=m4.length(t.slice(8,11));(n=(r=t)[0],o=r[1],a=r[2],l=r[3],u=r[4],d=r[5],h=r[6],c=r[7],f=r[8],_=r[9],g=r[10],p=r[11],m=r[12],v=r[13],y=r[14],x=r[15],1/(n*((E=g*x)*d+(A=y*c)*_+(T=h*p)*v-((b=y*p)*d+(w=h*x)*_+(k=g*c)*v))+u*(b*o+(S=a*x)*_+(L=g*l)*v-(E*o+(B=y*l)*_+(P=a*p)*v))+f*(w*o+B*d+(F=a*c)*v-(A*o+S*d+(I=h*l)*v))+m*(k*o+P*d+I*_-(T*o+L*d+F*_))))<0&&(R=-R),e[0]=t[12],e[1]=t[13],e[2]=t[14];var C=m4.copy(t),U=1/R,z=1/M,D=1/O;C[0]*=U,C[1]*=U,C[2]*=U,C[4]*=z,C[5]*=z,C[6]*=z,C[8]*=D,C[9]*=D,C[10]*=D,function(t,e){var i=t[0],s=t[4],r=t[8],n=t[1],o=t[5],a=t[9],l=t[2],u=t[6],d=t[10],h=i+o+d;if(h>0){var c=.5/Math.sqrt(h+1);e[3]=.25/c,e[0]=(u-a)*c,e[1]=(r-l)*c,e[2]=(n-s)*c}else if(i>o&&i>d){var f=2*Math.sqrt(1+i-o-d);e[3]=(u-a)/f,e[0]=.25*f,e[1]=(s+n)/f,e[2]=(r+l)/f}else if(o>d){var _=2*Math.sqrt(1+o-i-d);e[3]=(r-l)/_,e[0]=(s+n)/_,e[1]=.25*_,e[2]=(a+u)/_}else{var g=2*Math.sqrt(1+d-i-o);e[3]=(n-s)/g,e[0]=(r+l)/g,e[1]=(a+u)/g,e[2]=.25*g}}(C,i),s[0]=R,s[1]=M,s[2]=O},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},identity:function(e){return(e=e||new t(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,i){return(i=i||new t(16))[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15],i},length:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},orthographic:function(e,i,s,r,n,o,a){return(a=a||new t(16))[0]=2/(i-e),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/(r-s),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2/(n-o),a[11]=0,a[12]=(e+i)/(e-i),a[13]=(s+r)/(s-r),a[14]=(n+o)/(n-o),a[15]=1,a},frustum:function(e,i,s,r,n,o,a){var l=i-e,u=r-s,d=o-n;return(a=a||new t(16))[0]=2*n/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*n/u,a[6]=0,a[7]=0,a[8]=(e+i)/l,a[9]=(r+s)/u,a[10]=-(o+n)/d,a[11]=-1,a[12]=0,a[13]=0,a[14]=-2*n*o/d,a[15]=0,a},perspective:function(e,i,s,r,n){n=n||new t(16);var o=Math.tan(.5*Math.PI-.5*e),a=1/(s-r);return n[0]=o/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(s+r)*a,n[11]=-1,n[12]=0,n[13]=0,n[14]=s*r*a*2,n[15]=0,n},translation:function(e,i,s,r){return(r=r||new t(16))[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e,r[13]=i,r[14]=s,r[15]=1,r},translate:function(e,i,s,r,n){n=n||new t(16);var o=e[0],a=e[1],l=e[2],u=e[3],d=e[4],h=e[5],c=e[6],f=e[7],_=e[8],g=e[9],p=e[10],m=e[11],v=e[12],y=e[13],x=e[14],E=e[15];return e!==n&&(n[0]=o,n[1]=a,n[2]=l,n[3]=u,n[4]=d,n[5]=h,n[6]=c,n[7]=f,n[8]=_,n[9]=g,n[10]=p,n[11]=m),n[12]=o*i+d*s+_*r+v,n[13]=a*i+h*s+g*r+y,n[14]=l*i+c*s+p*r+x,n[15]=u*i+f*s+m*r+E,n},xRotation:function(e,i){i=i||new t(16);var s=Math.cos(e),r=Math.sin(e);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=r,i[7]=0,i[8]=0,i[9]=-r,i[10]=s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},yRotation:function(e,i){i=i||new t(16);var s=Math.cos(e),r=Math.sin(e);return i[0]=s,i[1]=0,i[2]=-r,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=r,i[9]=0,i[10]=s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},zRotation:function(e,i){i=i||new t(16);var s=Math.cos(e),r=Math.sin(e);return i[0]=s,i[1]=r,i[2]=0,i[3]=0,i[4]=-r,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},xRotate:function(e,i,s){s=s||new t(16);var r=e[4],n=e[5],o=e[6],a=e[7],l=e[8],u=e[9],d=e[10],h=e[11],c=Math.cos(i),f=Math.sin(i);return s[4]=c*r+f*l,s[5]=c*n+f*u,s[6]=c*o+f*d,s[7]=c*a+f*h,s[8]=c*l-f*r,s[9]=c*u-f*n,s[10]=c*d-f*o,s[11]=c*h-f*a,e!==s&&(s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s},yRotate:function(e,i,s){s=s||new t(16);var r=e[0],n=e[1],o=e[2],a=e[3],l=e[8],u=e[9],d=e[10],h=e[11],c=Math.cos(i),f=Math.sin(i);return s[0]=c*r-f*l,s[1]=c*n-f*u,s[2]=c*o-f*d,s[3]=c*a-f*h,s[8]=c*l+f*r,s[9]=c*u+f*n,s[10]=c*d+f*o,s[11]=c*h+f*a,e!==s&&(s[4]=e[4],s[5]=e[5],s[6]=e[6],s[7]=e[7],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s},zRotate:function(e,i,s){s=s||new t(16);var r=e[0],n=e[1],o=e[2],a=e[3],l=e[4],u=e[5],d=e[6],h=e[7],c=Math.cos(i),f=Math.sin(i);return s[0]=c*r+f*l,s[1]=c*n+f*u,s[2]=c*o+f*d,s[3]=c*a+f*h,s[4]=c*l-f*r,s[5]=c*u-f*n,s[6]=c*d-f*o,s[7]=c*h-f*a,e!==s&&(s[8]=e[8],s[9]=e[9],s[10]=e[10],s[11]=e[11],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s},axisRotation:function(e,i,s){s=s||new t(16);var r=e[0],n=e[1],o=e[2],a=Math.sqrt(r*r+n*n+o*o),l=(r/=a)*r,u=(n/=a)*n,d=(o/=a)*o,h=Math.cos(i),c=Math.sin(i),f=1-h;return s[0]=l+(1-l)*h,s[1]=r*n*f+o*c,s[2]=r*o*f-n*c,s[3]=0,s[4]=r*n*f-o*c,s[5]=u+(1-u)*h,s[6]=n*o*f+r*c,s[7]=0,s[8]=r*o*f+n*c,s[9]=n*o*f-r*c,s[10]=d+(1-d)*h,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},axisRotate:function(e,i,s,r){r=r||new t(16);var n=i[0],o=i[1],a=i[2],l=Math.sqrt(n*n+o*o+a*a),u=(n/=l)*n,d=(o/=l)*o,h=(a/=l)*a,c=Math.cos(s),f=Math.sin(s),_=1-c,g=u+(1-u)*c,p=n*o*_+a*f,m=n*a*_-o*f,v=n*o*_-a*f,y=d+(1-d)*c,x=o*a*_+n*f,E=n*a*_+o*f,b=o*a*_-n*f,w=h+(1-h)*c,A=e[0],T=e[1],k=e[2],S=e[3],B=e[4],P=e[5],L=e[6],F=e[7],I=e[8],R=e[9],M=e[10],O=e[11];return r[0]=g*A+p*B+m*I,r[1]=g*T+p*P+m*R,r[2]=g*k+p*L+m*M,r[3]=g*S+p*F+m*O,r[4]=v*A+y*B+x*I,r[5]=v*T+y*P+x*R,r[6]=v*k+y*L+x*M,r[7]=v*S+y*F+x*O,r[8]=E*A+b*B+w*I,r[9]=E*T+b*P+w*R,r[10]=E*k+b*L+w*M,r[11]=E*S+b*F+w*O,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r},scaling:function(e,i,s,r){return(r=r||new t(16))[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},scale:function(e,i,s,r,n){return(n=n||new t(16))[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=i*e[3],n[4]=s*e[4],n[5]=s*e[5],n[6]=s*e[6],n[7]=s*e[7],n[8]=r*e[8],n[9]=r*e[9],n[10]=r*e[10],n[11]=r*e[11],e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n},multiply:function(e,i,s){s=s||new t(16);var r=i[0],n=i[1],o=i[2],a=i[3],l=i[4],u=i[5],d=i[6],h=i[7],c=i[8],f=i[9],_=i[10],g=i[11],p=i[12],m=i[13],v=i[14],y=i[15],x=e[0],E=e[1],b=e[2],w=e[3],A=e[4],T=e[5],k=e[6],S=e[7],B=e[8],P=e[9],L=e[10],F=e[11],I=e[12],R=e[13],M=e[14],O=e[15];return s[0]=r*x+n*A+o*B+a*I,s[1]=r*E+n*T+o*P+a*R,s[2]=r*b+n*k+o*L+a*M,s[3]=r*w+n*S+o*F+a*O,s[4]=l*x+u*A+d*B+h*I,s[5]=l*E+u*T+d*P+h*R,s[6]=l*b+u*k+d*L+h*M,s[7]=l*w+u*S+d*F+h*O,s[8]=c*x+f*A+_*B+g*I,s[9]=c*E+f*T+_*P+g*R,s[10]=c*b+f*k+_*L+g*M,s[11]=c*w+f*S+_*F+g*O,s[12]=p*x+m*A+v*B+y*I,s[13]=p*E+m*T+v*P+y*R,s[14]=p*b+m*k+v*L+y*M,s[15]=p*w+m*S+v*F+y*O,s},inverse:n,transformVector:function(e,i,s){s=s||new t(4);for(var r=0;r<4;++r){s[r]=0;for(var n=0;n<4;++n)s[r]+=i[n]*e[4*n+r]}return s},transformPoint:function(e,i,s){s=s||new t(3);var r=i[0],n=i[1],o=i[2],a=r*e[3]+n*e[7]+o*e[11]+e[15];return s[0]=(r*e[0]+n*e[4]+o*e[8]+e[12])/a,s[1]=(r*e[1]+n*e[5]+o*e[9]+e[13])/a,s[2]=(r*e[2]+n*e[6]+o*e[10]+e[14])/a,s},transformDirection:function(e,i,s){s=s||new t(3);var r=i[0],n=i[1],o=i[2];return s[0]=r*e[0]+n*e[4]+o*e[8],s[1]=r*e[1]+n*e[5]+o*e[9],s[2]=r*e[2]+n*e[6]+o*e[10],s},transformNormal:function(e,i,s){s=s||new t(3);var r=n(e),o=i[0],a=i[1],l=i[2];return s[0]=o*r[0]+a*r[1]+l*r[2],s[1]=o*r[4]+a*r[5]+l*r[6],s[2]=o*r[8]+a*r[9]+l*r[10],s},setDefaultType:function(e){var i=t;return t=e,i}}}(),l=function(){function t(t){console.log(t)}function e(e,i,s,r){var n=r||t,o=e.createShader(s);return e.shaderSource(o,i),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)?o:(n("*** Error compiling shader '"+o+"':"+e.getShaderInfoLog(o)),e.deleteShader(o),null)}function i(e,i,s,r,n){var o=n||t,a=e.createProgram();return i.forEach((function(t){e.attachShader(a,t)})),s&&s.forEach((function(t,i){e.bindAttribLocation(a,r?r[i]:i,t)})),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(o("Error in program linking:"+e.getProgramInfoLog(a)),e.deleteProgram(a),null)}function s(t,i,s,r){var n,o,a=document.getElementById(i);if(!a)throw"*** Error: unknown script element"+i;if(n=a.text,!s)if("x-shader/x-vertex"===a.type)o=t.VERTEX_SHADER;else if("x-shader/x-fragment"===a.type)o=t.FRAGMENT_SHADER;else if(o!==t.VERTEX_SHADER&&o!==t.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return e(t,n,s||o,r)}var r=["VERTEX_SHADER","FRAGMENT_SHADER"];function n(t,e){return e===t.SAMPLER_2D?t.TEXTURE_2D:e===t.SAMPLER_CUBE?t.TEXTURE_CUBE_MAP:void 0}function o(t,e){var i=0;function s(e,s){var r,o,a=t.getUniformLocation(e,s.name),l=s.type,u=s.size>1&&"[0]"===s.name.substr(-3);if(l===t.FLOAT&&u)return function(e){t.uniform1fv(a,e)};if(l===t.FLOAT)return function(e){t.uniform1f(a,e)};if(l===t.FLOAT_VEC2)return function(e){t.uniform2fv(a,e)};if(l===t.FLOAT_VEC3)return function(e){t.uniform3fv(a,e)};if(l===t.FLOAT_VEC4)return function(e){t.uniform4fv(a,e)};if(l===t.INT&&u)return function(e){t.uniform1iv(a,e)};if(l===t.INT)return function(e){t.uniform1i(a,e)};if(l===t.INT_VEC2)return function(e){t.uniform2iv(a,e)};if(l===t.INT_VEC3)return function(e){t.uniform3iv(a,e)};if(l===t.INT_VEC4)return function(e){t.uniform4iv(a,e)};if(l===t.BOOL)return function(e){t.uniform1iv(a,e)};if(l===t.BOOL_VEC2)return function(e){t.uniform2iv(a,e)};if(l===t.BOOL_VEC3)return function(e){t.uniform3iv(a,e)};if(l===t.BOOL_VEC4)return function(e){t.uniform4iv(a,e)};if(l===t.FLOAT_MAT2)return function(e){t.uniformMatrix2fv(a,!1,e)};if(l===t.FLOAT_MAT3)return function(e){t.uniformMatrix3fv(a,!1,e)};if(l===t.FLOAT_MAT4)return function(e){t.uniformMatrix4fv(a,!1,e)};if((l===t.SAMPLER_2D||l===t.SAMPLER_CUBE)&&u){for(var d=[],h=0;h<info.size;++h)d.push(i++);return function(e,i){return function(s){t.uniform1iv(a,i),s.forEach((function(s,r){t.activeTexture(t.TEXTURE0+i[r]),t.bindTexture(e,s)}))}}(n(t,l),d)}if(l===t.SAMPLER_2D||l===t.SAMPLER_CUBE)return r=n(t,l),o=i++,function(e){t.uniform1i(a,o),t.activeTexture(t.TEXTURE0+o),t.bindTexture(r,e)};throw"unknown type: 0x"+l.toString(16)}for(var r={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),a=0;a<o;++a){var l=t.getActiveUniform(e,a);if(!l)break;var u=l.name;"[0]"===u.substr(-3)&&(u=u.substr(0,u.length-3));var d=s(e,l);r[u]=d}return r}function a(t,e){t=t.uniformSetters||t,Object.keys(e).forEach((function(i){var s=t[i];s&&s(e[i])}))}function l(t,e){var i={};function s(e){return function(i){t.bindBuffer(t.ARRAY_BUFFER,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i.numComponents||i.size,i.type||t.FLOAT,i.normalize||!1,i.stride||0,i.offset||0)}}for(var r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),n=0;n<r;++n){var o=t.getActiveAttrib(e,n);if(!o)break;var a=t.getAttribLocation(e,o.name);i[o.name]=s(a)}return i}function u(t,e){t=t.attribSetters||t,Object.keys(e).forEach((function(i){var s=t[i];s&&s(e[i])}))}function d(t,e,i,s){var r=t.createVertexArray();return t.bindVertexArray(r),u(e,i),s&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.bindVertexArray(null),r}function h(t,e,i){u(e,i.attribs),i.indices&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.indices)}var c,f=["","MOZ_","OP_","WEBKIT_"];function _(t,e,i){return function(t,e){var i=0;return t.push=function(){for(var e=0;e<arguments.length;++e){var s=arguments[e];if(s instanceof Array||s.buffer&&s.buffer instanceof ArrayBuffer)for(var r=0;r<s.length;++r)t[i++]=s[r];else t[i++]=s}},t.reset=function(t){i=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}(new(i||Float32Array)(t*e),t)}function g(t,e,i,s){i=i||t.ARRAY_BUFFER;var r=t.createBuffer();return t.bindBuffer(i,r),t.bufferData(i,e,s||t.STATIC_DRAW),r}function p(t){return"indices"!==t}function m(t,e){if(e instanceof Int8Array)return t.BYTE;if(e instanceof Uint8Array)return t.UNSIGNED_BYTE;if(e instanceof Int16Array)return t.SHORT;if(e instanceof Uint16Array)return t.UNSIGNED_SHORT;if(e instanceof Int32Array)return t.INT;if(e instanceof Uint32Array)return t.UNSIGNED_INT;if(e instanceof Float32Array)return t.FLOAT;throw"unsupported typed array type"}function v(t){return t.buffer&&t.buffer instanceof ArrayBuffer}function y(t,e){var i;if(e%(i=t.indexOf("coord")>=0?2:t.indexOf("color")>=0?4:3)>0)throw"can not guess numComponents. You should specify it.";return i}function x(t,e){if(v(t))return t;if(t.data&&v(t.data))return t.data;Array.isArray(t)&&(t={data:t}),t.numComponents||(t.numComponents=y(e,t.length));var i=t.type;i||"indices"===e&&(i=Uint16Array);var s=_(t.numComponents,t.data.length/t.numComponents|0,i);return s.push(t.data),s}function E(t,e,i){var s=i||function(t){var e={};return Object.keys(t).filter(p).forEach((function(t){e["a_"+t]=t})),e}(e),r={};return Object.keys(s).forEach((function(i){var n,o=s[i],a=e[o],l=x(a,o);r[i]={buffer:g(t,l),numComponents:a.numComponents||l.numComponents||y(o),type:m(t,l),normalize:(n=l,n instanceof Int8Array||n instanceof Uint8Array)}})),r}function b(t,e,i,s,r){var n=e.indices;i=void 0===i?t.TRIANGLES:i;var o=void 0===s?e.numElements:s;r=void 0===r?0:r,n?t.drawElements(i,o,t.UNSIGNED_SHORT,r):t.drawArrays(i,r,o)}return!!!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(c=HTMLCanvasElement.prototype.getContext,function(){var t=arguments,e=t[0];return"webgl"===e&&((t=[].slice.call(arguments))[0]="experimental-webgl"),c.apply(this,t)})),{createAugmentedTypedArray:_,createAttribsFromArrays:E,createBuffersFromArrays:function(t,e){var i={};return Object.keys(e).forEach((function(s){var r="indices"===s?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER,n=x(e[s],name);i[s]=g(t,n,r)})),e.indices?i.numElements=e.indices.length:e.position&&(i.numElements=e.position.length/3),i},createBufferInfoFromArrays:function(t,e,i){var s={attribs:E(t,e,i)},r=e.indices;return r?(r=x(r,"indices"),s.indices=g(t,r,t.ELEMENT_ARRAY_BUFFER),s.numElements=r.length):s.numElements=function(t){var e=t[Object.keys(t)[0]];return v(e)?e.numElements:e.data.length/e.numComponents}(e),s},createAttributeSetters:l,createProgram:i,createProgramFromScripts:function(t,e,n,o,a){for(var l=[],u=0;u<e.length;++u)l.push(s(t,e[u],t[r[u]],a));return i(t,l,n,o,a)},createProgramFromSources:function(t,s,n,o,a){for(var l=[],u=0;u<s.length;++u)l.push(e(t,s[u],t[r[u]],a));return i(t,l,n,o,a)},createProgramInfo:function(t,e,i,s,r){e=e.map((function(t){var e=document.getElementById(t);return e?e.text:t}));var n=webglUtils.createProgramFromSources(t,e,i,s,r);return n?{program:n,uniformSetters:o(t,n),attribSetters:l(t,n)}:null},createUniformSetters:o,createVAOAndSetAttributes:d,createVAOFromBufferInfo:function(t,e,i){return d(t,e.attribSetters||e,i.attribs,i.indices)},drawBufferInfo:b,drawObjectList:function(t,e){var i=null,s=null;e.forEach((function(e){var r=e.programInfo,n=e.bufferInfo,o=!1;r!==i&&(i=r,t.useProgram(r.program),o=!0),(o||n!==s)&&(s=n,h(t,r.attribSetters,n)),a(r.uniformSetters,e.uniforms),b(t,n)}))},glEnumToString:function(t,e){var i=[];for(var s in t)t[s]===e&&i.push(s);return i.length?i.join(" | "):"0x".concat(e.toString(16))},getExtensionWithKnownPrefixes:function(t,e){for(var i=0;i<f.length;++i){var s=f[i]+e,r=t.getExtension(s);if(r)return r}},resizeCanvasToDisplaySize:function(t,e){e=e||1;var i=t.clientWidth*e|0,s=t.clientHeight*e|0;return(t.width!==i||t.height!==s)&&(t.width=i,t.height=s,!0)},setAttributes:u,setBuffersAndAttributes:h,setUniforms:a}}();function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],s=!0,r=!1,n=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(t){r=!0,n=t}finally{try{s||null==a.return||a.return()}finally{if(r)throw n}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}function h(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.screen=null,this.canvas=null,this.assets=null,this.ctx=null,this.gl=null,this.imageProgram=null,this.squareProgram=null,this.textureInfoArray={}}var e,i,s;return e=t,(i=[{key:"init",value:function(t){this.screen=document.getElementById("screen"),this.canvas=document.createElement("canvas"),this.canvas.id="MainCanvas",this.canvas.width=240,this.canvas.height=320,this.canvas.style.zIndex=8,this.canvas.style.position="absolute",this.screen.appendChild(this.canvas),this.gl=this.canvas.getContext("experimental-webgl",{preserveDrawingBuffer:!0}),this.assets=t,this.imageProgram=l.createProgram(this.gl,this.createImageShaders()),this.squareProgram=l.createProgram(this.gl,this.createSquareShaders()),this.positionLocation=this.gl.getAttribLocation(this.imageProgram,"a_position"),this.texcoordLocation=this.gl.getAttribLocation(this.imageProgram,"a_texcoord"),this.squarePositionLoc=this.gl.getAttribLocation(this.squareProgram,"a_position"),this.matrixLocation=this.gl.getUniformLocation(this.imageProgram,"u_matrix"),this.textureLocation=this.gl.getUniformLocation(this.imageProgram,"u_texture"),this.imageColorUniformLoc=this.gl.getUniformLocation(this.imageProgram,"u_color"),this.squareMatrixLocation=this.gl.getUniformLocation(this.squareProgram,"u_matrix"),this.squareColorUniformLoc=this.gl.getUniformLocation(this.squareProgram,"u_color"),this.suqareSizeUniformLoc=this.gl.getUniformLocation(this.squareProgram,"u_size"),this.squarePositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.squarePositionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0]),this.gl.STATIC_DRAW),this.positionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),this.gl.STATIC_DRAW),this.texcoordBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texcoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),this.gl.STATIC_DRAW),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND);for(var e=0,i=Object.entries(this.assets.images);e<i.length;e++){var s=u(i[e],2),r=s[0],n=s[1],o=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE);var a={width:1,height:1,texture:o};a.width=n.width,a.height=n.height,this.gl.bindTexture(this.gl.TEXTURE_2D,a.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.textureInfoArray[r]=a}}},{key:"loop",value:function(t,e){var i,s=this,r=Date.now()-1;!function n(){i=Date.now()-r,parseInt(1e3/i),t(i),s.gl.viewport(0,0,s.canvas.width,s.canvas.height),s.gl.clearColor(0,0,0,1),s.gl.clear(s.gl.COLOR_BUFFER_BIT),e(),r=Date.now(),window.requestAnimationFrame(n)}()}},{key:"drawSquare",value:function(t,e,i,s){this.gl.useProgram(this.squareProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.squarePositionBuffer),this.gl.enableVertexAttribArray(this.squarePositionLoc),this.gl.vertexAttribPointer(this.squarePositionLoc,2,this.gl.FLOAT,!1,0,0);var r=a.orthographic(0,this.canvas.width,this.canvas.height,0,-1,1);r=a.translate(r,e+s/2,i+s/2,0),r=a.scale(r,s,s,1),this.gl.uniformMatrix4fv(this.squareMatrixLocation,!1,r),this.gl.uniform1f(this.suqareSizeUniformLoc,s),this.gl.uniform4fv(this.squareColorUniformLoc,new Float32Array(t)),this.gl.drawArrays(this.gl.POINTS,0,1)}},{key:"drawImage",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.textureInfoArray[t];this.gl.bindTexture(this.gl.TEXTURE_2D,o.texture),this.gl.useProgram(this.imageProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texcoordBuffer),this.gl.enableVertexAttribArray(this.texcoordLocation),this.gl.vertexAttribPointer(this.texcoordLocation,2,this.gl.FLOAT,!1,0,0);var l=a.orthographic(0,this.canvas.width,this.canvas.height,0,-1,1),u=r?e+2*o.width:e,d=n?i+2*extureInfo.height:i,h=r?-1:1,c=n?-1:1;l=a.translate(l,u,d,0),l=a.scale(l,2*o.width*h,2*o.height*c,1),this.gl.uniformMatrix4fv(this.matrixLocation,!1,l),this.gl.uniform1i(this.textureLocation,0),this.gl.uniform4fv(this.imageColorUniformLoc,new Float32Array([1,1,1,s])),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}},{key:"createShader",value:function(t,e){var i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw"Could not compile WebGL program. \n\n"+this.gl.getShaderInfoLog(i);return i}},{key:"createSquareShaders",value:function(){return[this.createShader("\n\t\t\tattribute vec4 a_position;\n\t\t\tuniform mat4 u_matrix;\n\t\t\tuniform float u_size;\n\t\t\t\n\t\t\tvoid main() {\n\t\t\t\tgl_Position = u_matrix * a_position;\n\t\t\t\tgl_PointSize = u_size;\n\t\t\t}\n\t\t",this.gl.VERTEX_SHADER),this.createShader("\n\t\t\tprecision mediump float;\n\t\t\tuniform vec4 u_color;\n\t\t\t\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = u_color;\n\t\t\t}\n\t\t",this.gl.FRAGMENT_SHADER)]}},{key:"createImageShaders",value:function(){return[this.createShader("\n\t\t\tattribute vec4 a_position;\n\t\t\tattribute vec2 a_texcoord;\n\t\t\tuniform mat4 u_matrix;\n\t\t\tvarying vec2 v_texcoord;\n\t\t\t\n\t\t\tvoid main() {\n\t\t\t\tgl_Position = u_matrix * a_position;\n\t\t\t\tv_texcoord = a_texcoord;\n\t\t\t}\n\t\t",this.gl.VERTEX_SHADER),this.createShader("\n\t\t\tprecision mediump float;\n\t\t\tvarying vec2 v_texcoord;\n\t\t\tuniform vec4 u_color;\n\t\t\tuniform sampler2D u_texture;\n\t\t\t\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D(u_texture, v_texcoord) * u_color;\n\t\t\t}\n\t\t",this.gl.FRAGMENT_SHADER)]}}])&&h(e.prototype,i),s&&h(e,s),t}());function f(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var _=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,s;return e=t,(i=[{key:"init",value:function(t){this.screen=document.getElementById("screen"),this.canvas=document.createElement("canvas"),this.canvas.id="TransitionCanvas",this.width=240,this.height=320,this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.zIndex=99999999,this.canvas.style.position="absolute",this.screen.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1,this.speed=75,this.ctx.transform(1,0,0,-1,0,this.canvas.height),this.gl=t}},{key:"enter",value:function(t){var e=this,i=0;this.sampleSize=4,this.inLoop=setInterval((function(){if(e.sampleSize>40)return clearInterval(e.inLoop),void t();i+=1,e.pixelate(e.sampleSize),e.darken(i),e.sampleSize+=4}),this.speed)}},{key:"leave",value:function(t){var e=this;if(t){var i=10;this.sampleSize=40,this.outLoop=setInterval((function(){if(0==e.sampleSize)return clearInterval(e.outLoop),e.ctx.clearRect(0,0,e.width,e.height),void setTimeout(t,e.speed);e.pixelate(e.sampleSize),e.darken(i),i-=1,e.sampleSize-=4}),this.speed)}else this.ctx.clearRect(0,0,this.width,this.height)}},{key:"darken",value:function(t){7==t&&(this.ctx.fillStyle="rgba(0,0,0,0.25)",this.ctx.fillRect(0,0,this.width,this.height)),8==t&&(this.ctx.fillStyle="rgba(0,0,0,0.50)",this.ctx.fillRect(0,0,this.width,this.height)),9==t&&(this.ctx.fillStyle="rgba(0,0,0,0.75)",this.ctx.fillRect(0,0,this.width,this.height)),10==t&&(this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(0,0,this.width,this.height))}},{key:"pixelate",value:function(t){var e=this.gl.drawingBufferWidth,i=this.gl.drawingBufferHeight,s=new Uint8Array(e*i*4);this.gl.readPixels(0,0,e,i,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s);for(var r=0;r<i+t;r+=t)for(var n=0;n<e+t;n+=t){var o=4*(r*e+n),a=s.slice(o,o+4);this.ctx.fillStyle="rgb(".concat(a[0],", ").concat(a[1],", ").concat(a[2],")"),this.ctx.fillRect(n-t/2,r-t/2,t,t)}}},{key:"clamp",value:function(t,e,i){return Math.min(Math.max(t,Math.min(e,i)),Math.max(e,i))}}])&&f(e.prototype,i),s&&f(e,s),t}());function g(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var p=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.world=null,this.entities=null,this.global_x=576,this.global_y=192,this.size=32,this.gridList=[],this.timePassed=0}var e,i,s;return e=t,(i=[{key:"reset",value:function(){this.gridList=[],this.addBlock(0,0,"dirt"),this.addBlock(1,0,"dirt"),this.addBlock(2,0,"dirt"),this.addBlock(3,0,"air"),this.addBlock(3,1,"dirt"),this.addBlock(4,0,"dirt"),this.addBlock(5,0,"dirt"),this.addBlock(6,0,"dirt"),this.randomizeLine(3)}},{key:"addBlock",value:function(t,e,i){(t<0||t>6)&&(i="hard"),this.gridList.push({type:i,x:t,y:e})}},{key:"getBlockType",value:function(t,e){if(e<0)return null;for(var i=0;i<this.gridList.length;i++)if(this.gridList[i].x===t&&this.gridList[i].y===e)return this.gridList[i].type;return"empty"}},{key:"setBlock",value:function(t,e,i){for(var s=0;s<this.gridList.length;s++)if(this.gridList[s].x===t&&this.gridList[s].y===e){if(this.gridList[s]={type:i,x:t,y:e},"bad_dirt"===i)return;var r=this.getBlockType(t,e+1),n=this.getBlockType(t,e-1),o=this.getBlockType(t+1,e),a=this.getBlockType(t-1,e);if("empty"===r&&this.addBlock(t,e+1,"dirt"),"empty"===n&&this.addBlock(t,e-1,"dirt"),"empty"===o&&this.addBlock(t+1,e,"dirt"),"empty"===a&&this.addBlock(t-1,e,"dirt"),"foe"===r&&this.setBlock(t,e+1,"bad_dirt"),"foe"===n&&this.setBlock(t,e-1,"bad_dirt"),"foe"===o&&this.setBlock(t+1,e,"bad_dirt"),"foe"===a&&this.setBlock(t-1,e,"bad_dirt"),"air"===i){var l=!!n&&-1!==n.indexOf("treasure"),u=!!r&&-1!==r.indexOf("treasure"),d=!!o&&-1!==o.indexOf("treasure"),h=!!a&&-1!==a.indexOf("treasure");l&&(this.setBlock(t,e-1,"air"),this.entities.create(t,e-1,n)),u&&(this.setBlock(t,e+1,"air"),this.entities.create(t,e+1,r)),h&&(this.setBlock(t-1,e,"air"),this.entities.create(t-1,e,a)),d&&(this.setBlock(t+1,e,"air"),this.entities.create(t+1,e,o))}return}this.addBlock(t,e,i)}},{key:"updateGrid",value:function(t){this.gridList=this.gridList.filter((function(e){return e.y>=t-4})),this.randomizeLine(t+5)}},{key:"randomizeLine",value:function(t){for(var e=0;e<7;e++){var i=100*Math.random();i<=7?(i=Math.floor(100*Math.random()))<=20?this.setBlock(e,t,"treasure2"):i>20&&i<=40?this.setBlock(e,t,"treasure4"):i>40&&i<=60?this.setBlock(e,t,"treasure0"):i>60&&i<=80?this.setBlock(e,t,"treasure1"):i>80&&i<=85?this.setBlock(e,t,"treasure5"):i>85&&i<=90?this.setBlock(e,t,"treasure3"):i>95&&i<=100&&this.setBlock(e,t,"treasure6"):i>7&&i<12&&this.setBlock(e,t,"foe")}}},{key:"draw",value:function(t){if(!(this.gridList.length<1)){for(var e=0;e<this.gridList.length;e++){var i="air"===this.gridList[e].type,s=-1!==this.gridList[e].type.indexOf("treasure");if(i||s){var r=this.world.x+this.global_x+this.gridList[e].x*this.size,n=this.world.y+this.global_y+this.gridList[e].y*this.size;i?t.drawSquare([.721,.768,.831,1],r-1,n-1,34):t.drawSquare([.721,.768,.831,1],r,n,32)}}for(e=0;e<this.gridList.length;e++)if("air"!==this.gridList[e].type){var o=this.world.x+this.global_x+this.gridList[e].x*this.size,a=this.world.y+this.global_y+this.gridList[e].y*this.size;-1!==this.gridList[e].type.indexOf("treasure")&&t.drawImage(this.gridList[e].type,o,a),"dirt"!==this.gridList[e].type&&"hard"!==this.gridList[e].type||t.drawImage("dirt",o,a),"bad_dirt"===this.gridList[e].type&&t.drawImage("dirt",o,a)}}}}])&&g(e.prototype,i),s&&g(e,s),t}());function m(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function v(t,e,i,s){return i*t/s+e}function y(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var x=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sky_x=0,this.skyDistance=240,this.ground_length=568,this.ground_y=192,this.x=0,this.y=0,this.timePassed=0,this.titleAlpha=1}var e,i,s;return e=t,(i=[{key:"updateCamera",value:function(t){this.y=-(t-160)}},{key:"update",value:function(t){this.x>-this.ground_length&&(this.timePassed+=t,this.x=-m(this.timePassed/1e3,0,this.ground_length,10)),this.sky_x>-this.skyDistance&&(this.timePassed+=t,this.sky_x=-m(this.timePassed/1e3,0,this.skyDistance,10)),this.titleAlpha>0&&(this.titleAlpha=1-m(this.timePassed/1e3,0,1,10))}},{key:"draw",value:function(t){t.drawImage("sky",this.sky_x,this.y),t.drawImage("dithering",0,this.y),this.titleAlpha>0&&t.drawImage("title",4,this.y+14,this.titleAlpha),t.drawImage("ground",this.x,this.y+this.ground_y),t.drawImage("dirt",this.x+800,this.y+this.ground_y)}}])&&y(e.prototype,i),s&&y(e,s),t}());function E(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var b=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.world=null,this.assets=null,this.entities=null,this.game=null,this.grid=null,this.grid_x=2,this.grid_y=-1,this.grid_size=32,this.grid_startx=576,this.grid_starty=192,this.x=this.grid_startx+this.grid_x*this.grid_size,this.y=this.grid_starty+this.grid_y*this.grid_size,this.dx=this.x,this.dy=this.y,this.movingTime=0,this.dir="right",this.speed=.5,this.isMoving=!1,this.isFalling=!1,this.lastKeyPressed=!1,this.sprite="idle",this.last_sprite="idle",this.canMove=!1}var e,i,s;return e=t,(i=[{key:"reset",value:function(){this.grid_x=2,this.grid_y=-1,this.x=this.grid_startx+this.grid_x*this.grid_size,this.y=this.grid_starty+this.grid_y*this.grid_size,this.dx=this.x,this.dy=this.y,this.movingTime=0,this.dir="right",this.isMoving=!1,this.isFalling=!1,this.lastKeyPressed=!1,this.sprite="idle",this.canMove=!1}},{key:"update",value:function(t){this.y<this.dy&&(this.isFalling=!0,this.sprite="move",this.movingTime+=t,this.y+=v(this.movingTime/1e3,0,this.grid_size,this.speed)),this.y>=this.dy&&this.isFalling&&(this.y=this.dy,this.movingTime=0,this.isFalling=!1,this.sprite="idle",this.assets.playSound("step"),this.calculateGridPosition(),this.grid.updateGrid(this.grid_y),this.entities.clean(this.grid_y)),"right"===this.dir?(this.x<this.dx&&(this.isMoving=!0,this.sprite="move",this.movingTime+=t,this.x+=v(this.movingTime/1e3,0,this.grid_size,this.speed)),this.x>=this.dx&&this.isMoving&&(this.x=this.dx,this.movingTime=0,this.isMoving=!1,this.sprite="idle",this.calculateGridPosition(),"left"===this.lastKeyPressed&&(this.dir="left"))):"left"===this.dir&&(this.x>this.dx&&(this.isMoving=!0,this.sprite="move",this.movingTime+=t,this.x-=v(this.movingTime/1e3,0,this.grid_size,this.speed)),this.x<=this.dx&&this.isMoving&&(this.x=this.dx,this.movingTime=0,this.isMoving=!1,this.sprite="idle",this.calculateGridPosition(),"right"===this.lastKeyPressed&&(this.dir="right"))),this.world.updateCamera(this.y)}},{key:"draw",value:function(t){t.drawImage(this.sprite,this.world.x+this.x,this.world.y+this.y,1,"left"===this.dir)}},{key:"onKeyDown",value:function(t){var e=this;if(this.canMove){if("4"===t||"ArrowLeft"===t){this.lastKeyPressed="left";var i="air"===this.grid.getBlockType(this.grid_x-1,this.grid_y)||null===this.grid.getBlockType(this.grid_x-1,this.grid_y);i&&this.assets.playSound("step"),this.isMoving||this.isFalling||!i||(this.dir="left",this.movingTime=0,this.dx=this.x-this.grid_size),i&&!this.isFalling||(this.dir="left")}if("6"===t||"ArrowRight"===t){this.lastKeyPressed="right";var s="air"===this.grid.getBlockType(this.grid_x+1,this.grid_y)||null===this.grid.getBlockType(this.grid_x+1,this.grid_y);s&&this.assets.playSound("step"),this.isMoving||this.isFalling||!s||(this.dir="right",this.movingTime=0,this.dx=this.x+this.grid_size),s&&!this.isFalling||(this.dir="right")}if("5"===t||"Enter"===t){this.assets.playSound("dig"),this.sprite="dig";var r="dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y),n="dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y),o="bad_dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y),a="bad_dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y);"right"===this.dir&&r?this.grid.setBlock(this.grid_x+1,this.grid_y,"air"):"right"===this.dir&&o&&(this.grid.setBlock(this.grid_x+1,this.grid_y,"air"),this.entities.create(this.grid_x+1,this.grid_y,"foe")),"left"===this.dir&&n?this.grid.setBlock(this.grid_x-1,this.grid_y,"air"):"left"===this.dir&&a&&(this.grid.setBlock(this.grid_x-1,this.grid_y,"air"),this.entities.create(this.grid_x-1,this.grid_y,"foe")),setTimeout((function(){return e.sprite="idle"}),150)}if("8"===t||"ArrowDown"===t){this.assets.playSound("dig"),this.sprite="dig";var l="dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y),u="dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y),d="dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y+1)||"empty"===this.grid.getBlockType(this.grid_x+1,this.grid_y+1),h="dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y+1)||"empty"===this.grid.getBlockType(this.grid_x-1,this.grid_y+1),c="bad_dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y),f="bad_dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y),_="bad_dirt"===this.grid.getBlockType(this.grid_x+1,this.grid_y+1)||"foe"===this.grid.getBlockType(this.grid_x+1,this.grid_y+1),g="bad_dirt"===this.grid.getBlockType(this.grid_x-1,this.grid_y+1)||"foe"===this.grid.getBlockType(this.grid_x-1,this.grid_y+1);"right"===this.dir&&(l&&this.grid.setBlock(this.grid_x+1,this.grid_y,"air"),c&&(this.grid.setBlock(this.grid_x+1,this.grid_y,"air"),this.entities.create(this.grid_x+1,this.grid_y,"foe")),d&&this.grid.setBlock(this.grid_x+1,this.grid_y+1,"air"),_&&(this.grid.setBlock(this.grid_x+1,this.grid_y+1,"air"),this.entities.create(this.grid_x+1,this.grid_y+1,"foe"))),"left"===this.dir&&(u&&this.grid.setBlock(this.grid_x-1,this.grid_y,"air"),f&&(this.grid.setBlock(this.grid_x-1,this.grid_y,"air"),this.entities.create(this.grid_x-1,this.grid_y,"foe")),h&&this.grid.setBlock(this.grid_x-1,this.grid_y+1,"air"),g&&(this.grid.setBlock(this.grid_x-1,this.grid_y+1,"air"),this.entities.create(this.grid_x-1,this.grid_y+1,"foe"))),setTimeout((function(){return e.sprite="idle"}),150)}}}},{key:"burn",value:function(){var t=this;this.last_sprite=this.sprite,this.assets.playSound("hurt"),this.sprite="hurt",setTimeout((function(){t.sprite=t.last_sprite}),500),this.game.substractTime(10)}},{key:"calculateGridPosition",value:function(){var t=this;this.grid_x=Math.floor((this.x-this.grid_startx)/this.grid_size),this.grid_y=Math.floor((this.y-this.grid_starty)/this.grid_size),"air"===this.grid.getBlockType(this.grid_x,this.grid_y+1)&&(this.isFalling||(this.movingTime=0,this.dy=this.y+this.grid_size)),this.entities.removeAtPos(this.grid_x,this.grid_y,(function(e){var i=!1,s=!1;if(e.forEach((function(e){switch(e){case"treasure2":t.game.addPoints(15),i=!0;break;case"treasure4":t.game.addPoints(20),i=!0;break;case"treasure0":t.game.addPoints(25),i=!0;break;case"treasure1":t.game.addPoints(30),i=!0;break;case"treasure5":t.game.addPoints(80),i=!0;break;case"treasure3":t.game.addPoints(100),i=!0;break;case"treasure6":t.game.addTime(15),i=!0;break;case"scorpion":s=!0,t.last_sprite=t.sprite,t.sprite="hurt",t.canMove=!1,setTimeout((function(){t.sprite=t.last_sprite,t.canMove=!0}),1e3);break;case"fire":t.burn()}})),i){var r=t.game.score>=t.game.goal?1.25:1;t.assets.playSound("good",r)}s&&t.assets.playSound("hurt")}))}}])&&E(e.prototype,i),s&&E(e,s),t}());function w(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var A=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.list=[],this.world=null,this.assets=null,this.player=null,this.grid=null,this.gravity=.1,this.speed=2,this.elapsedTime=0,this.shouldFlip=!1}var e,i,s;return e=t,(i=[{key:"create",value:function(t,e,i){var s=this.world.x+this.grid.global_x+t*this.grid.size,r=this.world.y+this.grid.global_y+e*this.grid.size;"foe"===i&&(i=Math.random()>=.5?"scorpion":"fire"),this.list.push({type:i,grid_x:t,grid_y:e,x:s,y:r,dx:s,dy:r,isFalling:!1,isMoving:!1,dir:"right",newborn:!0,fallingTime:0,movingTime:0})}},{key:"reset",value:function(){this.list=[]}},{key:"clean",value:function(t){this.list=this.list.filter((function(e){return e.grid_y>=t-4}))}},{key:"canBurnItem",value:function(t,e){if(this.list<1)return!1;for(var i=0;i<this.list.length;i++){var s=-1!==this.list[i].type.indexOf("treasure")||"scorpion"===this.list[i].type;if(this.list[i].grid_x===t&&this.list[i].grid_y===e&&s)return!0}return!1}},{key:"removeAtPos",value:function(t,e,i){if(this.list<1)return!1;for(var s=[],r=0;r<this.list.length;r++)this.list[r].grid_x===t&&this.list[r].grid_y===e&&(s.push(this.list[r].type),this.list[r]=null);return s.length>0&&(this.list=this.list.filter((function(t){return null!==t})),i(s),!0)}},{key:"update",value:function(t){var e=this;if(!(this.list.length<1)){this.elapsedTime+=t,this.elapsedTime>=500&&(this.shouldFlip=!this.shouldFlip,this.elapsedTime=0);for(var i=0;i<this.list.length;i++){var s=this.grid.getBlockType(this.list[i].grid_x,this.list[i].grid_y+1);if(this.list[i].y=this.world.y+this.grid.global_y+this.list[i].grid_y*this.grid.size,"fire"===this.list[i].type){var r=this.grid.getBlockType(this.list[i].grid_x+1,this.list[i].grid_y),n=this.grid.getBlockType(this.list[i].grid_x-1,this.list[i].grid_y);if("air"===r&&"right"===this.list[i].dir&&!this.list[i].isFalling&&(this.list[i].newborn&&(this.list[i].newborn=!1),this.list[i].isMoving||(this.list[i].movingTime=0,this.list[i].dx=this.list[i].x+this.grid.size),this.list[i].x<this.list[i].dx&&(this.list[i].isMoving=!0,this.list[i].movingTime+=t,this.list[i].x+=v(this.list[i].movingTime/1e3,0,this.grid.size,this.speed)),this.list[i].x>=this.list[i].dx&&this.list[i].isMoving)){if(this.list[i].x=this.list[i].dx,this.list[i].movingTime=0,this.list[i].isMoving=!1,this.list[i].grid_x+=1,this.list[i].grid_x===this.player.grid_x&&this.list[i].grid_y===this.player.grid_y&&(this.player.burn(),this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){}))))continue;if(this.canBurnItem(this.list[i].grid_x,this.list[i].grid_y)&&this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){return e.assets.playSound("hurt")})))continue;"air"!==this.grid.getBlockType(this.list[i].grid_x+1,this.list[i].grid_y)&&(this.list[i].dir="left")}if("air"===n&&("left"===this.list[i].dir||this.list[i].newborn)&&!this.list[i].isFalling&&(this.list[i].newborn&&(this.list[i].newborn=!1,this.list[i].dir="left"),this.list[i].isMoving||(this.list[i].movingTime=0,this.list[i].dx=this.list[i].x-this.grid.size),this.list[i].x>this.list[i].dx&&(this.list[i].isMoving=!0,this.list[i].movingTime+=t,this.list[i].x-=v(this.list[i].movingTime/1e3,0,this.grid.size,this.speed)),this.list[i].x<=this.list[i].dx&&this.list[i].isMoving)){if(this.list[i].x=this.list[i].dx,this.list[i].movingTime=0,this.list[i].isMoving=!1,this.list[i].grid_x-=1,this.list[i].grid_x===this.player.grid_x&&this.list[i].grid_y===this.player.grid_y&&(this.player.burn(),this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){}))))continue;if(this.canBurnItem(this.list[i].grid_x,this.list[i].grid_y)&&this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){return e.assets.playSound("hurt")})))continue;"air"!==this.grid.getBlockType(this.list[i].grid_x-1,this.list[i].grid_y)&&(this.list[i].dir="right")}}if("air"===s&&(this.list[i].isFalling||(this.list[i].fallingTime=0,this.list[i].dy=this.list[i].y+this.grid.size),this.list[i].y<this.list[i].dy&&(this.list[i].isFalling=!0,this.list[i].fallingTime+=t,this.list[i].y+=v(this.list[i].fallingTime/1e3,0,this.grid.size,this.gravity)),this.list[i].y>=this.list[i].dy&&this.list[i].isFalling&&(this.list[i].y=this.list[i].dy,this.list[i].fallingTime=0,this.list[i].isFalling=!1,this.list[i].grid_y+=1,"fire"===this.list[i].type))){if(this.list[i].grid_x===this.player.grid_x&&this.list[i].grid_y===this.player.grid_y&&(this.player.burn(),this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){}))))continue;if(this.canBurnItem(this.list[i].grid_x,this.list[i].grid_y)&&this.removeAtPos(this.list[i].grid_x,this.list[i].grid_y,(function(){return e.assets.playSound("hurt")})))continue}}}}},{key:"draw",value:function(t){if(!(this.list.length<1))for(var e=0;e<this.list.length;e++)"scorpion"===this.list[e].type||"fire"===this.list[e].type?t.drawImage(this.list[e].type,this.list[e].x,this.list[e].y,1,this.shouldFlip):t.drawImage(this.list[e].type,this.list[e].x,this.list[e].y)}}])&&w(e.prototype,i),s&&w(e,s),t}());function T(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var k=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ui=null,this.player=null,this.assets=null,this.grid=null,this.transition=null,this.entities=null,this.level=1,this.maxTime=60,this.remainingTime=this.maxTime,this.goal=500,this.score=0,this.started=!1,this.elapsedTime=0,this.freeze=!1}var e,i,s;return e=t,(i=[{key:"addPoints",value:function(t){this.score+=t,this.ui.updateScore(this.score,this.goal)}},{key:"addTime",value:function(t){this.remainingTime+t>=this.maxTime?this.remainingTime=this.maxTime:this.remainingTime+=t}},{key:"substractTime",value:function(t){this.remainingTime-t<=0?this.remainingTime=0:this.remainingTime-=t}},{key:"endLevel",value:function(){var t=this;this.transition.enter((function(){if(t.player.reset(),t.grid.reset(),t.entities.reset(),t.freeze=!1,t.goal>t.score)return t.ui.showGameOver(),void t.transition.leave();if(t.score>=t.goal){var e=(t.score-t.goal)/t.goal;t.maxTime=Math.floor(t.maxTime*(1+e/2)),t.level+=1;var i=Math.floor(1.5*t.goal);t.goal=i-i%5}t.remainingTime=t.maxTime,t.score=0,t.ui.isActive=!1,t.ui.updateScore(t.score,t.goal),t.ui.updateTime(t.remainingTime,t.maxTime),t.ui.updateLevel(t.level),t.transition.leave((function(){t.ui.show()}))}))}},{key:"update",value:function(t){var e=this;if(this.started&&(this.elapsedTime+=t,this.elapsedTime>=1e3)){if(this.remainingTime-=1,this.elapsedTime=0,this.remainingTime<=0){this.started=!1,this.freeze=!0;var i=null;this.goal<this.score&&(i=setInterval((function(){return e.assets.playSound("good")}),180)),setTimeout((function(){null!==i?(clearInterval(i),e.assets.playSound("start")):e.assets.playSound("loose"),e.endLevel()}),1500)}this.ui.updateTime(this.remainingTime,this.maxTime)}}}])&&T(e.prototype,i),s&&T(e,s),t}());function S(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,s;return e=t,(i=[{key:"init",value:function(){var t=this;window.onload=function(){navigator.userAgent.includes("KAIOS")&&navigator.requestWakeLock("screen"),r.init(),o.load().then((function(){c.init(o),_.init(c.gl),document.addEventListener("keydown",t.keyboardEventHandler),p.reset(),p.world=x,p.entities=A,A.world=x,A.grid=p,A.assets=o,A.player=b,b.assets=o,b.world=x,b.game=k,b.grid=p,b.entities=A,k.ui=r,k.player=b,k.grid=p,k.entities=A,k.assets=o,k.transition=_,r.prepareAd(),o.playSound("start"),setTimeout((function(){r.updateScore(k.score,k.goal),r.show()}),5e3),c.loop(t.update,t.draw)}))}}},{key:"update",value:function(t){k.freeze||(x.update(t),b.update(t),A.update(t),k.update(t))}},{key:"draw",value:function(){x.draw(c),p.draw(c),A.draw(c),b.draw(c)}},{key:"keyboardEventHandler",value:function(t){if(t.preventDefault(),r.isActive&&!b.canMove&&!k.started)return b.canMove=!0,k.started=!0,void r.hideDialog();k.freeze||b.onKeyDown(t.key),"Backspace"===t.key&&confirm("Are you sure you want to quit the game?")&&window.close(),"1"===t.key&&o.turnVolumeDown(),"3"===t.key&&o.turnVolumeUp()}}])&&S(e.prototype,i),s&&S(e,s),t}())).init()}]);